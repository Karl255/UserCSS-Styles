/* ==UserStyle==
@name         Moj TVZ Dark
@author       Karl_255 (Karlo Bistrički)
@namespace    github.com/Karl255
@version      1.2.4
@description  Tamna tema za moj.tvz.hr
@homepageURL  https://github.com/Karl255/UserCSS-Styles
@supportURL   https://github.com/Karl255/UserCSS-Styles/issues
@license      MIT
@preprocessor less

@var color  bg-color-base     "Base background color"                hsl(210, 5%, 10%)
@var number bg-l-increment    "Background color lightness increment" 5%
@var number btn-hover-ligthen "Button color lighten/darken on hover" -5%

@var color  info-color        "'Info' color"    #0b3c85
@var color  success-color     "'Success' color" #117A11
@var color  warning-color     "'Warning' color" #8F6F0E
@var color  danger-color      "'Danger' color"  #900F0F

@var color  text-color        "Text color"                                      whitesmoke
@var color  hc-text-color     "High contrast text color for colored background" white
@var color  link-color        "Link color"                                      #60b1f7
==/UserStyle== */
@-moz-document domain("moj.tvz.hr") {
	* {
		box-shadow: none !important;
		text-shadow: none !important;
		scrollbar-color: lighten(@bg-color-base, 20%) @bg-color-base;
	}

	:root {
		color: @text-color;
		
		@border-color-base: lighten(@bg-color-base, @bg-l-increment);

		--bg-200: @bg-color-base;                               // bottom/base panels
		--bg-300: lighten(@bg-color-base, @bg-l-increment);     // hovered elements, some elements
		--bg-400: lighten(@bg-color-base, 2 * @bg-l-increment); // navbar, modal, most elements
		--border-200: @border-color-base;
		--border-300: lighten(@border-color-base, @bg-l-increment);
		--border-400: lighten(@border-color-base, 2 * @bg-l-increment);
	}

	/* login page only */
	body:not([background]) {
		> .main-section {
			background: url(https://moj.tvz.hr/slika/back.png), white;
			background-blend-mode: exclusion;

			display: grid;
			
			// stack everything in the same area
			> * {
				grid-area: 1 / 1;
			}
			
			// for images that might be added (tested with some of the commented HTML code)
			> :not(.container-fluid) img {
				object-fit: contain;
				max-height: 100vh
			}
			
			// for centering of login div
			> .container-fluid > .row {
				display: grid;
				place-content: center;
				min-height: 60vh; // set to 100vh for vertical centering
			}

			.login-image-main {
				background-color: var(--bg-200);
				border: 1px solid var(--border-200);
				margin: 0;

				.user-image-section > img {
					width: 100%;
				}
			}
		}
	
		// useless hr that breaks page height
		> hr {
			display: none;
		}
	}

	/* rest */
	body[background] {
		background-color: #ffffff;
		background-blend-mode: exclusion; // XOR grid pattern with white, eg. invert grid pattern colors
	}
	
	body {
		color: inherit;
	}
	
	/* navbar */
	.navbar {
		min-height: unset;
	}

	.navbar-default {
		background: var(--bg-400);
		border-color: var(--border-400);

		box-shadow: none;
	}
	
	// mobile only navbar toggle icon
	.navbar-header {
		display: none;
	}
	
	// to properly center the right part of the navbar
	.navbar-right {
		margin-left: auto; // push self to the right
		display: flex;
		align-items: center;
	}

	.navbar-collapse.collapse {
		display: flex !important;
		align-items: center;
	}

	.navbar-form {
		margin: 0;
	}
	
	// navbar links
	.navbar-nav a {
		color: inherit !important;

		text-shadow: none !important;
		text-decoration: none;
	}

	.navbar-collapse > .navbar-nav > li > a {
		padding-top: 8px;
		padding-bottom: 8px;
	}
	
	// navbar opened dropdowns
	.navbar-default .navbar-nav > .open > a {
		&,
		&:hover,
		&:focus {
			background-color: var(--bg-300);
		}
	}

	.dropdown-menu {
		background-color: var(--bg-300);
		background-clip: revert;
		border-color: var(--border-300);

		& > li > a {
			color: inherit;

			&:hover,
			&:focus {
				color: inherit;
				background: var(--bg-400);
			}
		}
	}

	/* panels, alerts and such */
	
	// mixins
	#bootstrap-colors-bg() {
		&-info    { background: @info-color; }
		&-success { background: @success-color; }
		&-warning { background: @warning-color; }
		&-danger  { background: @danger-color; }
	}
	
	#bootstrap-colors-panel-heading() {
		// NOTE: bootstrap has "priamry panels", but they're not used on moj.tvz.hr
		&-default .panel-heading { background: var(--bg-300); color: inherit !important; }
		&-info    .panel-heading { background: @info-color; }
		&-success .panel-heading { background: @success-color; }
		&-warning .panel-heading { background: @warning-color; }
		&-danger  .panel-heading { background: @danger-color; }
	}
	
	#bootstrap-colors-lgi() {
		&-info    { background-color: @info-color; }
		&-success { background-color: @success-color; }
		&-warning { background-color: @warning-color; }
		&-danger  { background-color: @danger-color; }
		
		&-info,
		&-success,
		&-warning,
		&-danger {
			color: @hc-text-color;
			border: none;
		}
	}
	
	// panels
	.panel {
		background-color: var(--bg-200);
		#bootstrap-colors-panel-heading();
		border-color: var(--border-200);
		box-shadow: none;
	}

	.panel-heading {
		color: @hc-text-color !important;
		border-bottom: none;

		margin: -1px -1px 0 -1px; // single property to replace lots of border "magic"
	}
	
	// alert
	.alert {
		color: @hc-text-color;
		#bootstrap-colors-bg();
		border: none !important;

		box-shadow: none;
		text-shadow: none;
		
		// reset color for elements with a dark background
		select,
		input[type="submit"]{
			color: @text-color !important;
		}
	}
	
	// jumbotron
	.jumbotron {
		background-color: var(--bg-200);
	}
	
	// list group
	.list-group {
		box-shadow: none;
	}

	.list-group-item {
		color: inherit;
		background-color: var(--bg-200);
		#bootstrap-colors-lgi();
		border-color: var(--border-200);

		h5 {
			margin: 0;
		}
	}
	
	// modal
	.modal-content {
		background: var(--bg-400);
		border-color: var(--border-400);
	}

	.modal-header {
		border-color: var(--border-400);
	}

	.close {
		color: #ccc;
		text-shadow: none;
		opacity: 1;

		&:hover {
			color: #ccc;
			opacity: .5;
		}
	}

	/* inputs and buttons */
	input[type="text"],
	input[type="password"] {
		background-color: var(--bg-400);
		border: 1px solid var(--border-400);
		
		border-radius: 4px;
		padding: 4px 10px;
	}
	
	input[type="submit"]:not(.btn) {
		color: inherit;
		background-color: var(--bg-400);
		border: 1px solid var(--border-400);

		border-radius: 4px;
		padding: 4px 20px;
		
		&:hover,
		&:focus {
			background-color: var(--bg-300);
			border: 1px solid var(--border-300);
		}
	}

	button {
		color: inherit;
		background-color: var(--bg-400);
		border: 1px solid var(--border-400);

		border-radius: 4px;
		padding: 4px 20px;

		&:hover,
		&:focus {
			background-color: var(--bg-300);
			border: 1px solid var(--border-300);
		}
	}
	
	// for simplicity, this basically "assumes" that the button has .btn-default, classes like .btn-info will have a higher specificity and override this
	.btn {
		color: inherit;
		background: var(--bg-400);
		border-color: var(--border-400);

		box-shadow: none !important;
		text-shadow: none !important;
		text-decoration: none;

		&:hover,
		&:focus {
			color: inherit;
			background: var(--bg-300);
			border-color: var(--border-300);
		}
		
		.navbar-nav &:not(.modal &) {
			background-color: var(--bg-400);
			border: 1px solid var(--border-400);

			&:hover,
			&:focus {
				background-color: var(--bg-300);
				border-color: var(--border-300);
			}
		}
	}
	
	@btn-border-darken: 4%; // no need to have this configurable
	
	#bootstrap-color-btn(@color) {
		color: @hc-text-color;
		background: @color;
		border-color: darken(@color, @btn-border-darken);
		
		&:hover,
		&:focus {
			background: lighten(@color, @btn-hover-ligthen);
			border-color: lighten(@color, @btn-hover-ligthen - @btn-border-darken);
		}
	}

	.btn.btn-default {
		color: inherit;
	}
	
	.btn-info { #bootstrap-color-btn(@info-color); }
	.btn.btn-success { #bootstrap-color-btn(@success-color); }
	.btn.btn-warning { #bootstrap-color-btn(@warning-color); }
	.btn.btn-danger { #bootstrap-color-btn(@danger-color); }

	.btn-disabled {
		pointer-events: none;
	}
	
	// pagination buttons
	.pagination > .paginate_button > a {
		background-color: var(--bg-400);
		border-color: var(--border-400);

		&:hover,
		&:focus {
			background-color: var(--bg-300);
			border-color: var(--border-300);
		}
	}
	
	// regular select input
	select {
		color: inherit;
		background: var(--bg-400);
		border: 1px solid var(--border-400);
		padding: 8px 20px;
		border-radius: 4px;
	}
	
	// select input "select2"
	.select2-container {
		.select2-choice {
			color: inherit;
			background: var(--bg-300);
			border-color: var(--border-300);

			box-shadow: none !important;

			height: unset;
			padding: 4px 10px !important;

			.select2-arrow {
				background: var(--bg-300);
				border-color: var(--border-300);

				& > b {
					background-position-y: 5px;
				}
			}
		}
	}
	
	// tabs
	.nav-tabs {
		border-color: var(--border-300);
	}

	.nav-tabs > li > a,
	.nav-tabs.nav-justified > li > a {
			color: inherit;
			background-color: var(--bg-400);
			border-color: var(--border-400);

			text-decoration: none;

			&:hover,
			&:focus {
				color: inherit;
				background-color: var(--bg-300);
				border-color: var(--border-300);
		}
	}

	// active aka current tab
	.nav-tabs > li.active > a,
	.nav-tabs.nav-justified > .active > a {
		color: inherit;
		background-color: var(--bg-300);
		border-color: var(--border-300);

		text-decoration: none;
		
		&:hover,
		&:focus {
			color: inherit;
			background-color: var(--bg-300);
			border-color: var(--border-300);
		}
	}
	
	// ensure all tabs have the same height; issue with multiline text in justified tabs
	// NOTE: don't add this to regular tabs as well, those are designed to wrap and this will mess that up, because the li elements aren't display: table-cell
	.nav-tabs.nav-justified > li {
		height: 100%;
		
		> a {
			height: 100%;
		}
	}

	.select2-drop {
		color: inherit;
		background-color: var(--bg-300);
		border-color: var(--border-300);

		input {
			background: url("select2.png"), var(--bg-200);
			border-color: var(--border-200);
		}
	}

	.select2-results {
		.select2-no-results,
		.select2-searching,
		.select2-selection-limit {
			background: none;
		}
	}
	
	// "form-control"
	.form-control {
		color: inherit;
		background-color: var(--bg-300);
		border-color: var(--border-300);
	}

	/* tables */
	
	.table > thead > tr > th,
	.table > tbody > tr > td {
		border-color: var(--border-300);
	}
	
	// calendar/schedule table
	.table-hover > tbody > tr:hover {
		& > th,
		& > td {
			background-color: var(--bg-300);
		}
	}
	
	.table-striped > tbody tr:nth-child(2n+1) > td {
		background-color: var(--bg-300);
	}
	
	.table-bordered {
		border-color: var(--border-300);
	}

	.fc {
		background-color: var(--bg-200);
	}

	.fc-unthemed {
		thead,
		tbody,
		th,
		td,
		hr,
		.fc-row,
		.fc-popover {
			border-color: var(--border-300);
		}

		hr {
			background: var(--border-300);
		}
	}

	.fc td.fc-today {
		background-color: var(--bg-300);
	}

	.fc-button {
		color: inherit;
		background: var(--bg-400);
		border-color: var(--border-400);

		&:hover,
		&:focus {
			background: var(--bg-300);
			border-color: var(--border-300);
		}
	}

	.fc-state-disabled {
		pointer-events: none;
	}
	
	// table height fix
	.fc-time-grid-container {
		height: unset !important;
	}

	/* typography/rest */
	p,
	h1,
	h2,
	h3,
	h4,
	h5,
	h6 {
		color: inherit;
	}

	a {
		color: @link-color;
		text-decoration: underline;

		&:hover,
		&:focus {
			color: desaturate(darken(@link-color, 25%), 25%);
		}
	}
	
	// why do things like this even exist on that website? an issue with the website's own text editor I assume
	[style*="color: #000000"],
	[style*="color: #333333"]{
		color: inherit !important;
	}
	
	// idk why this was set, but it looks bad, so I'm reverting it (not for monospace, just in case)
	span[style*="font-family"]:not([style*="font-family: monospace"]) {
		font-family: inherit !important;
	}
	
	// prevent images extending past its parent, causing it to go under text (white text on a white picture = not good)
	img:not(table img) {
		max-width: 100%;
	}
	
	// remove height of clearfix itself
	.clearfix {
		margin-bottom: -10px;
	}
	
	// has a really nasty contrast
	.panel-info font[color="red"] {
		color: contrast(@info-color, #ff0000, #fb7d22); // picks the better contrast; for when a custom color is used
	}
}
